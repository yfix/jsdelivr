/**
 * @file better-dom.js
 * @version 2.0.0-beta.2 2014-08-25T19:42:31
 * @overview Live extension playground
 * @copyright 2013-2014 Maksim Chemerisuk
 * @license MIT
 * @see https://github.com/chemerisuk/better-dom
 */
(function(){function a(a){var b=arguments[1];void 0===b&&(b="$Element");var c="http://chemerisuk.github.io/better-dom/"+b+".html#"+a;this.message=b+"#"+a+" was called with illegal arguments. Check "+c+" to verify the method call"}function b(b){a.call(this,b,"DOM")}function c(a){return a&&a.__dom__?a.__dom__:this instanceof c?(a&&(a.__dom__=this,this[0]=a),void(this._={_handlers:[],_watchers:{},_visibility:""})):new c(a)}function d(a){ib.forEach(function(b){b.accept(a)&&b(a,!0)}),u.each.call(a.children,d)}function e(a,b){var c="contains"===a?"hasClass":a+"Class";return l.classList&&(b=function(b){return this[0].classList[a](b)}),"hasClass"===c?function(a){var c=arguments;return this[0]?1===c.length?b.call(this,a):u.every.call(c,b,this):void 0}:function(a){var c=arguments;return 1===c.length?b.call(this,a):u.each.call(c,b,this),this}}function f(b,d,e,f){return function(){var g=arguments[0];void 0===g&&(g="");var h=this[0];if(!(e||h.parentNode&&g!==v))return this;if("function"==typeof g&&(g=g(this)),"string"==typeof g)g&&(g=d?g.trim():v.create(g)[0]);else if(g instanceof c)g=g[0];else{if(!u.isArray(g))throw new a(b);g=g.reduce(function(a,b){return a.appendChild(b[0]),a},k.createDocumentFragment())}return g&&"string"==typeof g?h.insertAdjacentHTML(d,g):(g||!d)&&f(h,g),this}}function g(b,d,e){return function(f,g){if(f&&"string"!=typeof f)throw new a(b);var h=J(f),i=e?[]:null,j=this[0];for(j=j&&!g?j[d]:j;j;j=j[d])if(1===j.nodeType&&(!h||h(j))){if(!e)break;i.push(j)}return e?function(){var a,b,d,e=[];for(a=0,b=i.length;b>a;)d=i[a++],e.push(c(d));return e}():c(j)}}function h(b){return function(d){if(b){if(d&&"string"!=typeof d)throw new a("children")}else if(d&&"number"!=typeof d)throw new a("child");var e=this[0],f=J(d),g=e?e.children:null;return e?(p||(g=function(){var a,b,c,d=[];for(a=0,b=g.length;b>a;)c=g[a++],1===c.nodeType&&d.push(c);return d}()),b?function(){var a,b,d,e=[];for(a=0,b=g.length;b>a;)d=g[a++],f&&f(d)&&e.push(c(d));return e}():(0>d&&(d=g.length+d),c(g[d]))):b?[]:new c}}var i=Array.prototype.slice,j=window,k=j.document,l=k.documentElement,m=j.navigator.userAgent,n=j.CSSKeyframesRule||!k.attachEvent,o=~m.indexOf("Android")&&m.indexOf("Chrome")<0,p=!!k.addEventListener,q=j.WebKitAnimationEvent?"-webkit-":"",r="dataavailable";a.prototype=new TypeError,b.prototype=new TypeError;var s=Array.prototype,t=k.scripts[0],u={computeStyle:function(a){return j.getComputedStyle?j.getComputedStyle(a):a.currentStyle},injectElement:function(a){return t.parentNode.insertBefore(a,t)},slice:s.slice,every:s.every,each:s.forEach,isArray:Array.isArray,keys:Object.keys};c.prototype.toString=function(){var a=this[0];return a?a.tagName.toLowerCase():""};var v=new c(l);v.version="2.0.0-beta.2",j.DOM=v,v.constructor=function(a){if(!a)return[];if("nodeType"in a){if(1!==a.nodeType)return[];a=[a]}else if(!("length"in a))throw new b("constructor");return function(){var b,d,e,f=[];for(b=0,d=a.length;d>b;)e=a[b++],f.push(c(e));return f}()};var w=/^(?:[a-zA-Z-]+|\s*(<.+>)\s*)$/,x=k.createElement("body");v.create=function(a,d,e){var f,g,h=w.exec(a);if(a&&h&&!h[1])f=k.createElement(a),e&&(f=[f]);else{if(h&&h[1])a=d?v.format(h[1],d):h[1];else{if("string"!=typeof a)throw new b("create");a=v.emmet(a,d)}for(x.innerHTML=a,f=e?[]:null;g=x.firstChild;)if(x.removeChild(g),1===g.nodeType){if(!e){f=g;break}f.push(g)}}return e?function(){var a,b,d,e=[];for(a=0,b=f.length;b>a;)d=f[a++],e.push(c(d));return e}():c(f)},v.createAll=function(a,b){return v.create(a,b,!0)};var y={"(":1,")":2,"^":3,">":4,"+":4,"*":5,"`":6,"]":5,"[":6,".":7,"#":8},z=/([\w\-]+)(?:=((?:(`|')((?:\\?.)*)?\3)|[^\s]+))?/g,A=/(\$+)(?:@(-)?(\d+)?)?/g,B="area base br col hr img input link meta param command keygen source".split(" ").reduce(function(a,b){return a[b]="<"+b+">",a},{}),C=function(a){return a.join?a.join(""):a},D=function(a,b,c,d,e){return d&&"`"!==d||(d='"'),b+"="+d+(e||c||b)+d},E=function(a,b){return function(c){var d=b?c.indexOf(">"):c.lastIndexOf("<");return c.substr(0,d)+a+c.substr(d)}},F=function(a){var b=B[a];return b||(b=B[a]="<"+a+"></"+a+">"),b},G=function(a,b){var c,d=[];for(c=0;a>c;++c)d.push(b.replace(A,function(b,d,e,f){var g=(e?a-c-1:c)+(f?+f:1);return(d+g).slice(-d.length).split("$").join("0")}));return d};v.emmet=function(a,c){var d,e;if("string"!=typeof a)throw new b("emmet");if(!a)return a;c&&(a=v.format(a,c));var f,g,h,i,j=[],k=[],l="";if(a in B)return B[a];for(d=0,e=a.length,i;e>d;)if(i=a[d++],"."===i&&"."===j[0]&&(i=" "),f=y[i],!f||g&&g!==i)l+=i;else{if("+"===i&&"`"===j[0]&&(i=">"),"^"===i&&"^"===j[0]&&j.shift(),l&&(k.push(l),l=""),"("!==i)for(;y[j[0]]>f&&(k.push(j.shift()),"^"!==i||">"!==k[k.length-1]););")"===i?j.shift():g?g=!1:(j.unshift(i),"["===i&&(g="]"),"`"===i&&(g="`"))}if(d=e=void 0,l){if(!k.length&&!j.length)return F(l);k.push(l)}for(k=k.concat(j),j=[],d=0,e=k.length,i;e>d;){if(i=k[d++],i in y){switch(l=j.shift(),h=j.shift()||[""],"string"==typeof h&&(h=[F(h)]),i){case".":l=E(' class="'+l+'"',!0);break;case"#":l=E(' id="'+l+'"',!0);break;case"[":l=E(" "+l.replace(z,D),!0);break;case"`":l=E(l);break;case"*":h=G(+l,C(h));break;default:l="string"==typeof l?F(l):C(l),">"===i?l=E(l):h.push(l)}i="function"==typeof l?h.map(l):h}j.unshift(i)}return d=e=void 0,k=C(j[0]),c?k:B[a]=k};var H=/^(\w*)(?:#([\w\-]+))?(?:\[([\w\-\=]+)\])?(?:\.([\w\-]+))?$/,I="m oM msM mozM webkitM".split(" ").reduce(function(a,b){var c=b+"atchesSelector";return a||l[c]&&c},null),J=function(a,b){if("string"!=typeof a)return null;var c=H.exec(a);return c&&(c[1]&&(c[1]=c[1].toLowerCase()),c[3]&&(c[3]=c[3].split("=")),c[4]&&(c[4]=" "+c[4]+" ")),function(d){var e,f,g,h;for(c||I||(h=(b||document).querySelectorAll(a));d&&1===d.nodeType;d=d.parentNode){if(c)g=!(c[1]&&d.nodeName.toLowerCase()!==c[1]||c[2]&&d.id!==c[2]||c[3]&&(c[3][1]?d.getAttribute(c[3][0])!==c[3][1]:!d.hasAttribute(c[3][0]))||c[4]&&!((" "+d.className+" ").indexOf(c[4])>=0));else if(I)g=d[I](a);else{e=0,f=h.length;for(var i;f>e;)if(i=h[e++],i===d)return i;e=f=void 0}if(g||!b||d===b)break}return g&&d}},K={get:{},set:{}},L=/\-./g,M=/[A-Z]/g,N=["Top","Right","Bottom","Left"],O=u.computeStyle(l),P=O.length?u.slice.call(O,0):u.keys(O).map(function(a){return a.replace(M,function(a){return"-"+a.toLowerCase()})}),Q={font:["fontStyle","fontSize","/","lineHeight","fontFamily"],padding:N.map(function(a){return"padding"+a}),margin:N.map(function(a){return"margin"+a}),"border-width":N.map(function(a){return"border"+a+"Width"}),"border-style":N.map(function(a){return"border"+a+"Style"})};P.forEach(function(a){var b="-"===a[0]?a.substr(1,a.indexOf("-",1)-1):null,c=b?a.substr(b.length+2):a,d=a.replace(L,function(a){return a[1].toUpperCase()});d in O||(d=d[0].toLowerCase()+d.substr(1)),K.get[c]=function(a){return a[d]},K.set[c]=function(b,c){c="number"==typeof c?c+"px":c.toString(),b["cssText"in b?d:a]=c}})," float fill-opacity font-weight line-height opacity orphans widows z-index zoom ".split(" ").forEach(function(a){var b=a.replace(L,function(a){return a[1].toUpperCase()});"float"===a&&(b="cssFloat"in O?"cssFloat":"styleFloat",K.get[a]=function(a){return a[b]}),K.set[a]=function(c,d){c["cssText"in c?b:a]=d.toString()}}),u.keys(Q).forEach(function(a){var b=Q[a];K.get[a]=function(a){var c=[],d=function(b,d){return c.push("/"===b?b:a[b]),!c[d]};return b.some(d)?"":c.join(" ")},K.set[a]=function(c,d){d&&"cssText"in c?c.cssText+=";"+a+":"+d:b.forEach(function(a){return c[a]="number"==typeof d?d+"px":d.toString()})}});var R=K,S=u.injectElement(k.createElement("style")),T=S.sheet||S.styleSheet,U=T.cssRules||T.rules;v.importStyles=function(a,c){if(c&&"object"==typeof c){var d=u.keys(c).reduce(function(a,b){var d=R.set[b];return d?d(a,c[b]):a[b]=c[b],a},{});c=u.keys(d).map(function(a){return a+":"+d[a]}).join(";")}if("string"!=typeof a||"string"!=typeof c)throw new b("importStyles");T.cssRules?T.insertRule(a+"{"+c+"}",U.length):a.split(",").forEach(function(a){T.addRule(a,c)})};var V,W,X,Y,Z=v.importStyles,$=/^(on|do)[A-Z]/,_=[],ab=function(){return!0},bb=function(){return!1},cb=function(a,b){u.keys(b).forEach(function(c){"constructor"!==c&&(a[c]=b[c])})},db=function(a,b){return function(c){var d;c=c||j.event,d=n?c.animationName===W&&c.target===a:c.srcUrn===r&&c.srcElement===a,d&&((c._skip=c._skip||{})[b]=!0)}},eb=function(a,b){return function(c,d){!b[d]&&c.accept(a)&&c(a)}},fb=function(a){u.each.call(k.querySelectorAll(a.selector),a),Z(a.selector,Y)},gb=k.readyState,hb=function(){hb&&(_.forEach(fb),hb=!1)};if((k.attachEvent?"complete"===gb:"loading"!==gb)?setTimeout(hb,0):p?(j.addEventListener("load",hb,!1),k.addEventListener("DOMContentLoaded",hb,!1)):(j.attachEvent("onload",hb),k.attachEvent("ondataavailable",function(){"DOMContentLoaded"===j.event.srcUrn&&hb&&hb()})),n)V=q?"webkitAnimationStart":"animationstart",W="DOM"+Date.now(),Z("@"+q+"keyframes "+W,"from {opacity:.99} to {opacity:1}"),Y={"animation-duration":"1ms !important","animation-name":W+" !important"},k.addEventListener(V,function(a){a.animationName===W&&_.forEach(eb(a.target,a._skip||{}))},!1);else{if(V="ondataavailable",X=k.querySelector("link[rel=htc]"),!X)throw new Error("In order to use live extensions in IE < 10 you have to include extra files. See https://github.com/chemerisuk/better-dom#notes-about-old-ies");Y={behavior:"url("+X.href+") !important"},Z("html",Y),k.attachEvent(V,function(){var a=j.event;a.srcUrn===r&&_.forEach(eb(a.srcElement,a._skip||{}))})}v.extend=function(a,d,e){if(2===arguments.length&&(e=d,d=!0),"boolean"==typeof d&&(d=d?ab:bb),"function"==typeof e&&(e={constructor:e}),!e||"object"!=typeof e||"function"!=typeof d)throw new b("extend");if("*"===a)cb(c.prototype,e);else{var f=u.keys(e).filter(function(a){return!!$.exec(a)}),g=e.hasOwnProperty("constructor")&&e.constructor,h=_.length,i=function(a,b){var i=c(a);n?a.addEventListener(V,db(a,h),!1):a.attachEvent(V,db(a,h)),(b===!0||d(i)!==!1)&&(cb(i,e),g&&i.dispatch(g),b!==!0&&f.forEach(function(a){delete i[a]}))};i.accept=J(a),i.selector=a,_.push(i),hb||fb(i)}};var ib=_,jb=/\{([\w\-]+)\}/g;v.format=function(a,c){if("string"!=typeof a||c&&"object"!=typeof c)throw new b("format");return a.replace(jb,function(a,b){return b in c?String(c[b]):a})},v.importScripts=function(){var a=i.call(arguments,0),c=function(){var d,e=a.shift(),f=typeof e;if("string"===f)d=k.createElement("script"),d.src=e,d.onload=c,d.async=!0,u.injectElement(d);else if("function"===f)e();else if(e)throw new b("importScripts")};c()},v.mock=function(a,b,e){if(!a)return new c;var f=v.create(a,b,e);return e?f.forEach(function(a){d(a[0])}):d(f[0]),f},v.mockAll=function(a,b){return v.mock(a,b,!0)};var kb=0,lb=["r","webkitR","mozR","oR"].reduce(function(a,b){var c=b+"equestAnimationFrame";return a||j[c]&&c},0);v.raf=function(a){if(lb)j[lb](a);else{var b=Date.now(),c=Math.max(0,16-(b-kb));kb=b+c,c?setTimeout(a,c):a(b+c)}};var mb=/[\n\t\r]/g;c.prototype.hasClass=e("contains",function(a){return(" "+this[0].className+" ").replace(mb," ").indexOf(" "+a+" ")>=0}),c.prototype.addClass=e("add",function(a){this.hasClass(a)||(this[0].className+=" "+a)}),c.prototype.removeClass=e("remove",function(a){a=(" "+this[0].className+" ").replace(mb," ").replace(" "+a+" "," "),this[0].className=a.trim()}),c.prototype.toggleClass=e("toggle",function(a){var b=this[0].className;this.addClass(a),b===this[0].className&&this.removeClass(a)}),c.prototype.clone=function(){var b=arguments[0];if(void 0===b&&(b=!0),"boolean"!=typeof b)throw new a("clone");var d,e=this[0];return e?p?d=new c(e.cloneNode(b)):(d=v.create(e.outerHTML),b||d.set("innerHTML","")):d=new c,d},c.prototype.contains=function(b){var d=this[0];if(!d)return!1;if(b instanceof c){var e=b[0];return e===d?!0:d.contains?d.contains(e):16&d.compareDocumentPosition(e)}throw new a("contains")},c.prototype.css=function(b,c){var d,e,f,g,h=this,i=arguments.length,j=this[0],k=typeof b;if(1===i&&("string"===k||u.isArray(b)))return j&&(d=j.style,c=("string"===k?[b]:b).reduce(function(a,b){return e=R.get[b],c=e?e(d):d[b],f||c||(d=u.computeStyle(j),c=e?e(d):d[b],f=!0),a[b]=c,a},{})),j&&"string"===k?c[b]:c;if(j)if(d=j.style,g=function(a,b){var c=R.set[a];"function"==typeof b&&(b=b(h)),null==b&&(b=""),c?c(d,b):d[a]="number"==typeof b?b+"px":b.toString()},1===i&&b&&"object"===k)u.keys(b).forEach(function(a){g(a,b[a])});else{if(2!==i||"string"!==k)throw new a("style");g(b,c)}return this},c.prototype.dispatch=function(b){var c=i.call(arguments,1),d=this,e=this[0];if(e){if("string"==typeof b&&(d=e,b=e[b]),"function"!=typeof b)throw new a("dispatch");try{return b.apply(d,c)}catch(f){return"console"in j&&j.console.error(f),f}}};var nb=k.getElementsByClassName?/^(?:(\w+)|\.([\w\-]+))$/:/^(?:(\w+))$/,ob=/'|\\/g,pb="DOM"+Date.now();c.prototype.find=function(b){var d=arguments[1];if(void 0===d&&(d=""),"string"!=typeof b)throw new a("find"+d);var e,f,g,h,i=this[0],j=nb.exec(b);if(!i)return d?[]:new c;if(j)e=j[1]?i.getElementsByTagName(b):i.getElementsByClassName(j[2]),e&&!d&&(e=e[0]);else{f=!0,g=pb,h=i,this!==v&&((f=i.getAttribute("id"))?g=f.replace(ob,"\\$&"):i.setAttribute("id",g),g="[id='"+g+"'] ",b=g+b.split(",").join(","+g));try{e=h["querySelector"+d](b)}finally{f||i.removeAttribute("id")}}return d?function(){var a,b,d,f=[];for(a=0,b=e.length;b>a;)d=e[a++],f.push(c(d));return f}():c(e)},c.prototype.findAll=function(a){return this.find(a,"All")};var qb={};["scroll","mousemove"].forEach(function(a){qb[a]=function(a){var b=!0;return function(c){b&&(b=DOM.raf(function(){b=!a(c)}))}}}),"onfocusin"in l?(qb.focus=function(a){a._type="focusin"},qb.blur=function(a){a._type="focusout"}):qb.focus=qb.blur=function(a){a.capturing=!0},k.createElement("input").validity&&(qb.invalid=function(a){a.capturing=!0}),p||["submit","change","reset"].forEach(function(a){qb[a]=function(a){a._type=r}});var rb=qb,sb=["target","currentTarget","defaultPrevented"],tb=function(a,b,d,e,f,g,h){if(!g)return null;var i=rb[a],m=J(b,g),n=function(b){if(b=b||j.event,tb.skip!==a&&(n._type!==r||b.srcUrn===a)){var i=b.target||b.srcElement||k,o=m?m(i):g,q=b._args||[],s=e||sb,t=d;"string"==typeof d&&(t=f[d]||f.get(d)),"function"==typeof t&&o&&(h&&f.off(a,d),s=s.map(function(d){if("number"==typeof d)return q[d-1];if(!p)switch(d){case"which":return b.keyCode;case"button":var e=b.button;return 1&e?1:2&e?3:4&e?2:0;case"pageX":return b.pageX||b.clientX+l.scrollLeft-l.clientLeft;case"pageY":return b.clientY+l.scrollTop-l.clientTop}switch(d){case"type":return a;case"defaultPrevented":return"defaultPrevented"in b?b.defaultPrevented:b.returnValue===!1;case"target":return c(i);case"currentTarget":return c(o);case"relatedTarget":return c(b.relatedTarget||b[(b.toElement===g?"from":"to")+"Element"])}return b[d]}),t.apply(f,e?s:q.concat(s))===!1&&(p?b.preventDefault():b.returnValue=!1))}};return i&&(n=i(n,a)||n),p||"on"+(n._type||a)in g||(n._type=r),n.type=b?a+" "+b:a,n.callback=d,n},ub=tb;c.prototype.fire=function(b){var c,d,e,f=i.call(arguments,1),g=this[0],h=typeof b,j={};if(!g)return!1;if("string"!==h)throw new a("fire");return(c=rb[b])&&(j=c(j)||j),h=j._type||b,p?(d=k.createEvent("HTMLEvents"),d.initEvent(h,!0,!0),d._args=f,e=g.dispatchEvent(d)):(d=k.createEventObject(),d._args=f,"on"+h in g||(h=r),h===r&&(d.srcUrn=b),g.fireEvent("on"+h,d),e=d.returnValue!==!1),e&&g[b]&&("focus"!==b&&"blur"!==b||g.offsetWidth)&&(ub.skip=b,g[b](),ub.skip=null),e};var vb={get:{},set:{}};"tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" ").forEach(function(a){vb.get[a.toLowerCase()]=function(b){return b[a]}}),vb.get.style=function(a){return a.style.cssText},vb.set.style=function(a,b){a.style.cssText=b},vb.get.title=function(a){return a===l?k.title:a.title},vb.set.title=function(a,b){(a===l?k:a).title=b},vb.get.undefined=function(a){var b;switch(a.tagName){case"SELECT":return~a.selectedIndex?a.options[a.selectedIndex].value:"";case"OPTION":b=a.hasAttribute("value")?"value":"text";break;default:b=a.type&&"value"in a?"value":"innerHTML"}return a[b]},vb.set.value=function(a,b){"SELECT"===a.tagName?u.every.call(a.options,function(a){return!(a.selected=a.value===b)})&&(a.selectedIndex=-1):a[p||"textarea"!==a.type?"value":"innerText"]=b},vb.get.type=function(a){return a.getAttribute("type")||a.type},p||(vb.get.textContent=function(a){return a.innerText},vb.set.textContent=function(a,b){a.innerText=b});var wb=vb;c.prototype.get=function(b){var c,d,e=this,f=this._,g=this[0],h=wb.get[b],i=typeof b;if(g){if(h)return h(g,b);if("string"===i){if("-"===b[0]&&"-"===b[1]){if(c=b.substr(2),c in f)d=f[c];else if(d=g.getAttribute("data-"+c),null!=d){if("{"===d[0]&&"}"===d[d.length-1])try{d=JSON.parse(d)}catch(j){}f[c]=d}return d}return b in g?g[b]:g.getAttribute(b)}if(u.isArray(b))return b.reduce(function(a,b){return a[b]=e.get(b),a},{});throw new a("get")}},c.prototype.after=f("after","afterend",!1,function(a,b){a.parentNode.insertBefore(b,a.nextSibling)}),c.prototype.before=f("before","beforebegin",!1,function(a,b){a.parentNode.insertBefore(b,a)}),c.prototype.prepend=f("prepend","afterbegin",!0,function(a,b){a.insertBefore(b,a.firstChild)}),c.prototype.append=f("append","beforeend",!0,function(a,b){a.appendChild(b)}),c.prototype.replace=f("replace","",!1,function(a,b){a.parentNode.replaceChild(b,a)}),c.prototype.remove=f("remove","",!1,function(a){a.parentNode.removeChild(a)});var xb={};xb[":focus"]=function(a){return a===k.activeElement},xb[":hidden"]=function(a,b){return"true"===a.getAttribute("aria-hidden")||"none"===u.computeStyle(a).display||!v.contains(b)},xb[":visible"]=function(a,b){return!xb[":hidden"](a,b)};var yb=xb;c.prototype.matches=function(b){if(!b||"string"!=typeof b)throw new a("matches");var c=yb[b]||J(b),d=this[0];return d&&!!c(d,this)},c.prototype.off=function(b,c){if("string"!=typeof b)throw new a("off");var d=this[0];return d&&(this._._handlers=this._._handlers.filter(function(a){return b!==a.type||c&&c!==a.callback?!0:(b=a._type||a.type,void(p?d.removeEventListener(b,a,!!a.capturing):d.detachEvent("on"+b,a)))})),this},c.prototype.offset=function(){var a,b=this[0],c=l.clientTop,d=l.clientLeft,e=j.pageYOffset||l.scrollTop,f=j.pageXOffset||l.scrollLeft;return b?(a=b.getBoundingClientRect(),{top:a.top+e-c,left:a.left+f-d,right:a.right+f-d,bottom:a.bottom+e-c,width:a.right-a.left,height:a.bottom-a.top}):void 0},c.prototype.on=function(b,c,d,e){var f,g,h,i=this,j=typeof b;if("string"!==j){if("object"===j)return u.isArray(b)?(h=u.slice.call(arguments,1),b.forEach(function(a){i.on.apply(i,[a].concat(h))})):u.keys(b).forEach(function(a){i.on(a,b[a])}),this;throw new a("on")}g=b.indexOf(" "),~g&&(f=b.substr(g+1),b=b.substr(0,g)),u.isArray(d)||(e=d,d=void 0);var k=this[0],l=ub(b,f,c,d,this,k,e);return l&&(p?k.addEventListener(l._type||b,l,!!l.capturing):k.attachEvent("on"+(l._type||b),l),this._._handlers.push(l)),this},c.prototype.once=function(){var a=i.call(arguments,0);return this.on.apply(this,a.concat(!0))},c.prototype.set=function(b,c){var d=this,e=this[0];if(!e)return this;1===arguments.length&&"object"!=typeof b&&(c=null==b?"":String(b),b="value"in e?"value":"innerHTML");var f,g=wb.set[b],h=typeof b,i=this._._watchers[b],j=c;if(i&&(f=this.get(b)),g)g(e,j);else if("string"===h)"-"===b[0]&&"-"===b[1]?this._[b.substr(2)]=j:("function"==typeof j&&(j=c(this)),null==j?e.removeAttribute(b):b in e?e[b]=j:e.setAttribute(b,j),(!p||o)&&(e.className=e.className));else{if("object"!==h)throw new a("set");u.isArray(b)?b.forEach(function(a){d.set(a,c)}):u.keys(b).forEach(function(a){d.set(a,b[a])})}return i&&f!==j&&i.forEach(function(a){d.dispatch(a,j,f)}),this},c.prototype.next=g("next","nextSibling"),c.prototype.prev=g("prev","previousSibling"),c.prototype.nextAll=g("nextAll","nextSibling",!0),c.prototype.prevAll=g("prevAll","previousSibling",!0),c.prototype.parent=g("parent","parentNode"),c.prototype.child=h(!1),c.prototype.children=h(!0);var zb=!o&&n,Ab=["timing-function","property","duration","delay"].map(function(a){return"transition-"+a}),Bb=q?"webkitTransitionEnd":"transitionend",Cb=zb?["position","absolute"]:["display","none"],Db=function(a){var b=parseFloat(a)||0;return a.lastIndexOf("ms")===a.length-2?b:1e3*b},Eb=function(a,b,c){var d=R.get[b+"delay"](a).split(","),e=R.get[b+"duration"](a).split(",");return c||(c=R.get[b+"iteration-count"](a).split(",")),Math.max.apply(Math,e.map(function(a,b){var e=c[b]||"1";return("initial"===e?1:parseFloat(e))*Db(a)+(Db(d[b])||0)}))},Fb=function(a,b,c,d){var e=u.computeStyle(a),f=Math.max(Eb(e,"transition-",[]),Eb(e,"animation-"));if(f){var g,h,i,j;h=Ab.map(function(a,b){return R.get[a](e).split(b?", ":/, (?!\d)/)}),g=h[1].indexOf("visibility"),0>g&&(g=h[2].indexOf("0s")),0>g&&(g=h[0].length),h[0][g]="linear",h[1][g]="visibility",h[c?2:3][g]="0s",h[c?3:2][g]=f+"ms",h.forEach(function(a,c){R.set[Ab[c]](b,a.join(", "))}),b.visibility=c?"visible":"hidden",b.willChange=h[1].join(", "),i=function(b){b&&"visibility"!==b.propertyName||(b&&b.stopPropagation(),clearTimeout(j),a.removeEventListener(Bb,i,!1),d())},a.addEventListener(Bb,i,!1),j=setTimeout(i,f+1e3/60)}return f},Gb=function(a,b,c){return function(){var d=a[0],e=d.style,f="function"==typeof b?b(d):b,g=function(){"hidden"===e.visibility&&(e[Cb[0]]=Cb[1]),zb&&(e.willChange=""),c&&c(a,d)},h=function(){var b=zb?Fb(d,e,f,g):0;if(f){var c=e[Cb[0]];"none"!==c&&(a._._visibility=c)}else e[Cb[0]]=a._._visibility||"";e.visibility=f?"hidden":"visible",a.set("aria-hidden",String(f)),b||g()};v.contains(a)?v.raf(h):h()}},Hb=function(b,c){return function(d,e){var f=arguments.length,g=typeof d;if(1===f&&"function"===g&&(e=d,d=0),d&&("number"!==g||0>d)||e&&"function"!=typeof e)throw new a(b);return e=Gb(this,c,e),d?setTimeout(e,d):e(),this}};c.prototype.show=Hb("show",!1),c.prototype.hide=Hb("hide",!0),c.prototype.toggle=Hb("toggle",function(a){return"true"!==a.getAttribute("aria-hidden")}),c.prototype.watch=function(a,b){var c=this._._watchers;return c[a]||(c[a]=[]),c[a].push(b),this},c.prototype.unwatch=function(a,b){var c=this._._watchers;return c[a]&&(c[a]=c[a].filter(function(a){return a!==b})),this}}).call(this);