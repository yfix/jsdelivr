/*! Tablesaw - v0.1.2 - 2014-05-14
* https://github.com/filamentgroup/tablesaw
* Copyright (c) 2014 Filament Group; Licensed MIT */
!function(a){var b=document.createElement("div"),c=b.getElementsByTagName("i"),d=a(document.documentElement);b.innerHTML="<!--[if lte IE 8]><i></i><![endif]-->",c[0]&&d.addClass("ie-lte8"),"querySelector"in document&&(!window.blackberry||window.WebKitPoint)&&!window.operamini&&(d.addClass("tablesaw-enhanced"),a(function(){a(document).trigger("enhance.tablesaw")}))}(jQuery),function(a){var b="table",c={toolbar:"tablesaw-bar"},d={create:"tablesawcreate",destroy:"tablesawdestroy"},e="stack",f="table[data-mode],table[data-sortable]",g=function(b){if(!b)throw new Error("Tablesaw requires an element.");this.table=b,this.$table=a(b),this.mode=this.$table.attr("data-mode")||e,this.init()};g.prototype.init=function(){this.$table.attr("id")||this.$table.attr("id",b+"-"+Math.round(1e4*Math.random())),this.createToolbar();var c,e=this.table.querySelectorAll("thead tr"),f=this;a(e).each(function(){var b=0;a(this).children().each(function(){var d=parseInt(this.getAttribute("colspan"),10),g=":nth-child("+(b+1)+")";if(c=b+1,d)for(var h=0;d-1>h;h++)b++,g+=", :nth-child("+(b+1)+")";this.cells=f.$table.find("tr").not(a(e).eq(0)).not(this).children(g),b++})}),this.$table.trigger(d.create,[this.mode,c])},g.prototype.createToolbar=function(){var b=this.$table.prev("."+c.toolbar);b.length||(b=a("<div>").addClass(c.toolbar).insertBefore(this.$table)),this.$toolbar=b,this.mode&&this.$toolbar.addClass("mode-"+this.mode)},g.prototype.destroy=function(){this.$table.prev("."+c.toolbar).each(function(){this.className=this.className.replace(/\bmode\-\w*\b/gi,"")}),a(window).off("resize."+this.$table.attr("id")),this.$table.trigger(d.destroy,[this.mode]),this.$table.removeAttr("data-mode"),this.$table.removeData(b)},a.fn[b]=function(){return this.each(function(){var c=a(this);if(!c.data(b)){var d=new g(this);c.data(b,d)}})},a(document).on("enhance.tablesaw",function(c){a(c.target).find(f)[b]()})}(jQuery),function(a,b){var d={stackTable:"tablesaw-stack",cellLabels:"tablesaw-cell-label"},e={obj:"tablesaw-stack"},f={labelless:"data-no-labels"},g=function(a){this.$table=b(a),this.labelless=this.$table.is("["+f.labelless+"]"),this.labelless||(this.allHeaders=this.$table.find("th")),this.$table.data(e.obj,this)};g.prototype.init=function(a){if(this.$table.addClass(d.stackTable),!this.labelless){var c=b(this.allHeaders);c.each(function(){var c=b(this.cells),e=c.not(this).filter("thead th").length&&" tablesaw-cell-label-top",f=b(this).text();if(""!==f)if(e){var g=parseInt(b(this).attr("colspan"),10),h="";g&&(h="td:nth-child("+g+"n + "+a+")"),c.filter(h).prepend("<b class='"+d.cellLabels+e+"'>"+f+"</b>")}else c.prepend("<b class='"+d.cellLabels+"'>"+f+"</b>")})}},g.prototype.destroy=function(){this.$table.removeClass(d.stackTable),this.$table.find("."+d.cellLabels).remove()},b(document).on("tablesawcreate","table",function(a,b,c){if("stack"===b){var d=new g(this);d.init(c)}}),b(document).on("tablesawdestroy","table",function(a,c){"stack"===c&&b(this).data(e.obj).destroy()})}(this,jQuery),function(a){var b="tablesawbtn",c=".btn",d="btn-selected",e={_create:function(){return a(this).each(function(){a(this).trigger("beforecreate."+b)[b]("_init").trigger("create."+b)})},_init:function(){var c=a(this),d=void 0!==this.disabled&&this.disabled!==!1,e=this.getElementsByTagName("input")[0],f=this.getElementsByTagName("select")[0];return e&&a(this).addClass("btn-"+e.type)[b]("_formbtn",e),f&&a(this).addClass("btn-select")[b]("_select",f),d&&c.addClass("ui-disabled"),c},_formbtn:function(b){var c=function(b,c){if("radio"===c.type&&c.checked){var e=c.getAttribute("name");a("[name='"+e+"']").each(function(){a(this).parent().removeClass(d)}),b[c.checked?"addClass":"removeClass"](d)}else"checkbox"===c.type&&b[c.checked?"addClass":"removeClass"](d)};c(a(this),b),a(this).bind("click",function(){c(a(this),b)})},_select:function(b){var c=function(b,c){var e,f,g,d=a(c).find("option");if(d.each(function(){var a=this;a.selected&&(e=document.createTextNode(a.text))}),g=b.childNodes,d.length>0)for(var h=0,i=g.length;i>h;h++)f=g[h],f&&3===f.nodeType&&b.replaceChild(e,f)};c(this,b),a(this).bind("change refresh",function(){c(this,b)})}};a.fn[b]=function(c,d,e,f){return this.each(function(){return c&&"string"==typeof c?a.fn[b].prototype[c].call(this,d,e,f):a(this).data(b+"active")?a(this):(a(this).data(b+"active",!0),a.fn[b].prototype._create.call(this),void 0)})},a.extend(a.fn[b].prototype,e),a(document).on("enhance",function(d){a(c,d.target)[b]()})}(jQuery),function(a,b){var d=function(a){this.$table=b(a),this.classes={columnToggleTable:"tablesaw-columntoggle",columnBtnContain:"tablesaw-columntoggle-btnwrap tablesaw-advance",dialogClass:this.$table.attr("data-dialog-class")||"",columnBtn:"tablesaw-columntoggle-btn tablesaw-nav-btn",columnBtnSide:this.$table.attr("data-column-btn-side")||"right",popup:"tablesaw-columntoggle-popup",priorityPrefix:"tablesaw-priority-",toolbar:"tablesaw-bar"},this.i18n={columnBtnText:"Columns",columnsDialogError:"No eligible columns."},this.headers=this.$table.find("tr:first > th"),this.$table.data("tablesaw-coltoggle",this)};d.prototype.init=function(){var a,c,d,e,f,g,h=this;this.$table.addClass(this.classes.columnToggleTable),a=this.$table.attr("id"),c=a+"-popup",g=b("<div class='"+this.classes.columnBtnContain+" "+this.classes.columnBtnSide+" "+this.classes.dialogClass+"'></div>"),d=b("<a href='#"+c+"' class='btn btn-micro "+this.classes.columnBtn+"' data-popup-link>"+"<span>"+this.i18n.columnBtnText+"</span></a>"),e=b("<div class='dialog-table-coltoggle "+this.classes.popup+"' id='"+c+"'></div>"),f=b("<div class='btn-group'></div>");var i=!1;b(this.headers).not("td").each(function(){var a=b(this),c=a.attr("data-priority"),d=a.add(this.cells);c&&"persist"!==c&&(d.addClass(h.classes.priorityPrefix+c),b("<label class='btn btn-check btn-checkbox btn-selected theme-simple'><input type='checkbox' checked>"+a.text()+"</label>").appendTo(f).trigger("enhance").children(0).data("cells",d),i=!0)}),i||f.append('<label class="btn theme-simple">'+this.i18n.columnsDialogError+"</label>"),f.find(".btn").tablesawbtn(),f.appendTo(e),f.on("change",function(a){var c=a.target.checked;b(a.target).data("cells").toggleClass("tablesaw-cell-hidden",!c).toggleClass("tablesaw-cell-visible",c),h.$table.trigger("tablesawcolumns")}),d.appendTo(g),g.appendTo(this.$table.prev("."+this.classes.toolbar)),e.appendTo(g).dialog(!0),this.$menu=f,b(window).on("resize."+a,function(){h.refreshToggle()}),this.refreshToggle()},d.prototype.refreshToggle=function(){this.$menu.find("input").each(function(){var a=b(this);this.checked="table-cell"===a.data("cells").eq(0).css("display"),a.parent()[this.checked?"addClass":"removeClass"]("btn-selected")})},d.prototype.refreshPriority=function(){var a=this;b(this.headers).not("td").each(function(){var c=b(this),d=c.attr("data-priority"),e=c.add(this.cells);d&&"persist"!==d?e.addClass(a.classes.priorityPrefix+d):e.each(function(){this.className=this.className.replace(/\bui\-table\-priority\-\d\b/g,"")})})},d.prototype.destroy=function(){this.$table.removeClass(this.classes.columnToggleTable),this.$table.find("th, td").each(function(){var a=b(this);a.removeClass("tablesaw-cell-hidden").removeClass("tablesaw-cell-visible"),this.className=this.className.replace(/\bui\-table\-priority\-\d\b/g,"")})},b(document).on("tablesawcreate","table",function(a,b){if("columntoggle"===b){var c=new d(this);c.init()}}),b(document).on("tablesawdestroy","table",function(a,c){"columntoggle"===c&&b(this).data("tablesaw-coltoggle").destroy()})}(this,jQuery),function(a,b){function d(c){function n(a){return b(a.cells).add(a)}function o(a){n(a).removeClass("tablesaw-cell-hidden")}function p(a){n(a).addClass("tablesaw-cell-hidden")}function q(a){n(a).addClass("tablesaw-cell-persist")}function r(a){return b(a).is('[data-priority="persist"]')}function s(){c.removeClass(h),b("#"+m+"-persist").remove()}function t(){var a="#"+m+" ",d=[],e=c.width();i.each(function(c){var f;r(this)&&(f=b(this).width(),.75*e>f&&d.push(a+" .tablesaw-cell-persist:nth-child("+(c+1)+") { width: "+f+"px; }"))}),s(),c.addClass(h),l.append(b("<style>").attr("id",m+"-persist").html(d.join("\n")))}function u(){var c,a=[];return j.each(function(d){var e=b(this),f="none"===e.css("display");f||c?f&&c&&!a[1]&&(a[1]=d):(c=!0,a[0]=d)}),a}function v(){var a=u();return[a[1]-1,a[0]-1]}function w(a){return a?u():v()}function x(a){return a[1]>-1&&a[1]<j.length}function y(){var a=20,d=c.parent().width(),e=0;i.each(function(c){var f=b(this),g=f.is('[data-priority="persist"]');return e+=k[c]+(g?0:a),g?(q(this),void 0):(e>d?p(this):o(this),void 0)}),s(),c.trigger("tablesawcolumns")}function z(a){var b=w(a);x(b)&&(isNaN(b[0])&&(b[0]=a?0:j.length-1),t(),p(j.get(b[0])),o(j.get(b[1])),c.trigger("tablesawcolumns"))}var d=b("<div class='tablesaw-advance'></div>"),e=b("<a href='#' class='tablesaw-nav-btn btn btn-micro left' title='Previous Column'></a>").appendTo(d),f=b("<a href='#' class='tablesaw-nav-btn btn btn-micro right' title='Next Column'></a>").appendTo(d),g="disabled",h="tablesaw-fix-persist",i=c.find("thead th"),j=i.not('[data-priority="persist"]'),k=[],l=b(document.head||"head"),m=c.attr("id");c.css("width","auto"),i.each(function(){k.push(b(this).outerWidth())}),c.css("width",""),d.appendTo(c.prev(".tablesaw-bar")),c.addClass("tablesaw-swipe"),m||(m="tableswipe-"+Math.round(1e4*Math.random()),c.attr("id",m)),e.add(f).click(function(a){z(!!b(a.target).closest(f).length),a.preventDefault()}),c.bind("touchstart.swipetoggle",function(a){var e,f,d=(a.touches||a.originalEvent.touches)[0].pageX;c.addClass("table-noanimate"),b(this).bind("touchmove",function(a){e=(a.touches||a.originalEvent.touches)[0].pageX,f=e-d,-30>f&&(f=-30),f>30&&(f=30)}).bind("touchend.swipetoggle",function(){15>e-d&&z(!0),e-d>-15&&z(!1),b(this).unbind("touchmove touchend"),c.removeClass("table-noanimate")})}).bind("tablesawcolumns.swipetoggle",function(){e[x(v())?"removeClass":"addClass"](g),f[x(u())?"removeClass":"addClass"](g)}).bind("tablesawnext.swipetoggle",function(){z(!0)}).bind("tablesawprev.swipetoggle",function(){z(!1)}).bind("tablesawdestroy.swipetoggle",function(){var c=b(this);c.removeClass("tablesaw-swipe"),c.prev(".tablesaw-bar").find(".tablesaw-advance").remove(),b(a).off("resize",y),c.unbind(".swipetoggle")}),y(),b(a).on("resize",y)}b(document).on("tablesawcreate","table",function(a,c){var e=b(this);"swipe"===c&&d(e)})}(this,jQuery),function(a){function b(b){return a.map(b.childNodes,function(b){var c=a(b);if(c.is("input, select"))return c.val();if(!c.hasClass("tablesaw-cell-label"))return a.trim(c.text())}).join("")}var c="tablesaw-sortable",d="sortable",e="table[data-"+d+"]",f="[data-"+d+"-switch]",g={head:d+"-head",ascend:d+"-ascending",descend:d+"-descending",switcher:c+"-switch",tableToolbar:"tablesaw-toolbar"},h={sort:"Sort"},i={_create:function(b){return a(this).each(function(){var c=a(this).data("init"+d);return c?!1:(a(this).data("init"+d,!0).trigger("beforecreate."+d)[d]("_init",b).trigger("create."+d),void 0)})},_init:function(){var i,j,e=a(this),k=function(){e.addClass(c)},l=function(b){a.each(b,function(b,c){a(c).addClass(g.head)})},m=function(b,c){a.each(b,function(b,d){var e=a("<button />");e.bind("click",{col:d},c),a(d).wrapInner(e)})},n=function(b){a.each(b,function(b,c){var d=a(c);d.removeAttr("data-sortable-default-col"),d.removeClass(g.ascend),d.removeClass(g.descend)})},o=function(b){if(!a(b.target).is("a[href]")){b.stopPropagation();var c=a(this).parent(),f=b.data.col,h=i.index(c);n(c.siblings()),c.hasClass(g.descend)?(e[d]("sortBy",f,!0),h+="_asc"):(e[d]("sortBy",f),h+="_desc"),j&&j.find("select").val(h).trigger("refresh"),b.preventDefault()}},p=function(b){a.each(b,function(b,c){var d=a(c);d.is("[data-sortable-default-col]")&&(d.hasClass(g.descend)||d.addClass(g.ascend))})},q=function(c){j=a("<div>").addClass(g.switcher).addClass(g.tableToolbar).html(function(){var d=["<label>"+h.sort+":"];return d.push('<span class="btn btn-small">&#160;<select>'),c.each(function(c){var e=a(this),f=e.is("[data-sortable-default-col]"),h=e.hasClass(g.descend),i=!1;a(this.cells).slice(0,3).each(function(){return isNaN(parseInt(b(this),10))?void 0:(i=!0,!1)}),d.push("<option"+(f&&!h?" selected":"")+' value="'+c+'_asc">'+e.text()+" "+(i?"\u2191":"(A-Z)")+"</option>"),d.push("<option"+(f&&h?" selected":"")+' value="'+c+'_desc">'+e.text()+" "+(i?"\u2193":"(Z-A)")+"</option>")}),d.push("</select></span></label>"),d.join("")});var d=e.prev(".tablesaw-bar"),f=d.children().eq(0);f.length?j.insertBefore(f):j.appendTo(d),j.find(".btn").tablesawbtn(),j.find("select").on("change",function(){var b=a(this).val().split("_"),d=c.eq(b[0]);n(d.siblings()),e.sortable("sortBy",d.get(0),"asc"===b[1])})};k(),i=e.find("thead th[data-"+d+"-col]"),l(i),m(i,o),p(i),e.is(f)&&q(i,e.find("tbody tr:nth-child(-n+3)"))},getColumnNumber:function(b){return a(b).prevAll().length},getTableRows:function(){return a(this).find("tbody tr")},sortRows:function(c,d,e){var f,g,h,i=function(c){var e=[];return a.each(c,function(c,f){e.push({cell:b(a(f).children().get(d)),rowNum:c})}),e},j=function(a){var b;return b=a?function(a,b){return parseInt(a.cell,10)?parseInt(a.cell,10)-parseInt(b.cell,10):a.cell>b.cell?1:-1}:function(a,b){return parseInt(a.cell,10)?parseInt(b.cell,10)-parseInt(a.cell,10):a.cell<b.cell?1:-1}},k=function(a,b){var d,e,f,c=[];for(d=0,e=a.length;e>d;d++)f=a[d].rowNum,c.push(b[f]);return c};return f=i(c),g=j(e),h=f.sort(g),c=k(h,c)},replaceTableRows:function(b){var c=a(this),d=c.find("tbody");d.html(b)},makeColDefault:function(b,c){var d=a(b);d.attr("data-sortable-default-col","true"),c?(d.removeClass(g.descend),d.addClass(g.ascend)):(d.removeClass(g.ascend),d.addClass(g.descend))},notify:function(){},sortBy:function(b,c){var f,g,e=a(this);f=e[d]("getColumnNumber",b),g=e[d]("getTableRows"),g=e[d]("sortRows",g,f,c),e[d]("replaceTableRows",g),e[d]("makeColDefault",b,c),e[d]("notify")}};a.fn[d]=function(b){var e,c=Array.prototype.slice.call(arguments,1);return b&&"string"==typeof b?(e=a.fn[d].prototype[b].apply(this[0],c),"undefined"!=typeof e?e:a(this)):(a(this).data(d+"data")||(a(this).data(d+"active",!0),a.fn[d].prototype._create.call(this,b)),a(this))},a.extend(a.fn[d].prototype,i),a(document).on("tablesawcreate","table",function(){a(this).is(e)&&a(this)[d]()})}(jQuery),function(a,b){function e(c){function i(b){var c=b.attr(d.attr.init);return!c||a.matchMedia&&a.matchMedia(c).matches}function j(){if(!i(c))return e.hide(),void 0;e.show();var a=f.find("li").removeClass(g);c.find("thead th").each(function(c){"none"===b(this).css("display")&&a.eq(c).addClass(g)})}var e=b('<div class="tablesaw-advance minimap">'),f=b('<ul class="tablesaw-advance-dots">').appendTo(e),g="tablesaw-advance-dots-hide",h=c.find("thead th");h.each(function(){f.append("<li><i></i></li>")}),e.appendTo(c.prev(".tablesaw-bar")),j(),b(a).on("resize",j),c.bind("tablesawcolumns.minimap",function(){j()}).bind("tablesawdestroy.minimap",function(){var c=b(this);c.prev(".tablesaw-bar").find(".tablesaw-advance").remove(),b(a).off("resize",j),c.unbind(".minimap")})}var d={attr:{init:"data-minimap"}};b(document).on("tablesawcreate","table",function(a,c){var f=b(this);"swipe"!==c&&"columntoggle"!==c||!f.is("[ "+d.attr.init+"]")||e(f)})}(this,jQuery),function(a,b){var c={selectors:{init:"table[data-mode-switch]"},attributes:{excludeMode:"data-mode-exclude"},classes:{main:"tablesaw-modeswitch",toolbar:"tablesaw-toolbar"},modes:["stack","swipe","columntoggle"],i18n:{modes:["Stack","Swipe","Toggle"],columns:'Col<span class="a11y-sm">umn</span>s'},init:function(a){var d=b(a),e=d.attr(c.attributes.excludeMode),f=d.prev(".tablesaw-bar"),g="",h=b("<div>").addClass(c.classes.main+" "+c.classes.toolbar).html(function(){var f,a=["<label>"+c.i18n.columns+":"],b=d.attr("data-mode");a.push('<span class="btn btn-small">&#160;<select>');for(var h=0,i=c.modes.length;i>h;h++)e&&e.toLowerCase()===c.modes[h]||(f=b===c.modes[h],f&&(g=c.modes[h]),a.push("<option"+(f?" selected":"")+' value="'+c.modes[h]+'">'+c.i18n.modes[h]+"</option>"));return a.push("</select></span></label>"),a.join("")}),i=f.find(".tablesaw-advance").eq(0);i.length?h.insertBefore(i):h.appendTo(f),h.find(".btn").tablesawbtn(),h.find("select").bind("change",c.onModeChange)},onModeChange:function(){var a=b(this),d=a.closest("."+c.classes.main),e=a.closest(".tablesaw-bar").nextUntil(e).eq(0),f=a.val();d.remove(),e.data("table").destroy(),e.attr("data-mode",f),e.table()}};b(a.document).on("tablesawcreate","table",function(){b(this).is(c.selectors.init)&&c.init(this)})}(this,jQuery);