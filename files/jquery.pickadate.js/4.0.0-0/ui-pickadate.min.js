!function(a,b){"function"==typeof define&&define.amd?define("ui-pickadate",["jquery","shadow","ui-picker"],b):b(a.jQuery,a.shadow)}(this,function(a,b){"use strict";var c=b._,d=c.el,e=function(a){return(a>9?"":"0")+a};b("pickadate",{extend:"picker",attrs:{min:null,max:null,today:null,view:null,highlight:null,select:null,format:"d mmmm, yyyy",firstDay:null,show:null},dict:{today:"Today",clear:"Clear",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},classNames:{host:" --pickadate",header:"box box--header",body:"box box--body",footer:"box box--footer",container:"container",buttonScope:"button button--scope",buttonPrev:"button button--prev",buttonNext:"button button--next",buttonToday:"button button--today",buttonClear:"button button--clear",buttonDisabled:"button--disabled",grid:"grid",gridTitle:"grid-title",gridCell:"grid-cell",disabled:"grid-cell--disabled",selected:"grid-cell--selected",highlighted:"grid-cell--highlighted",now:"grid-cell--now",infocus:"grid-cell--infocus",outfocus:"grid-cell--outfocus"},formats:{d:function(a,b){return b?(a=a.match(/^\d{1,2}/),a&&a[0]):a[2]},dd:function(a,b){return b?(a=a.match(/^\d{1,2}/),a&&a[0]):e(a[2])},ddd:function(a,b){if(b)return a=a.match(/^\w+/),a&&a[0];var c=new Date(a[0],a[1],a[2]);return this.dict.weekdaysShort[c.getDay()]},dddd:function(a,b){if(b)return a=a.match(/^\w+/),a&&a[0];var c=new Date(a[0],a[1],a[2]);return this.dict.weekdaysFull[c.getDay()]},m:function(a,b){return b?(a=a.match(/^\d{1,2}/),a&&a[0]):a[1]+1},mm:function(a,b){return b?(a=a.match(/^\d{1,2}/),a&&a[0]):e(a[1]+1)},mmm:function(a,b){return b?(a=a.match(/^\w+/),a&&a[0]):this.dict.monthsShort[a[1]]},mmmm:function(a,b){return b?(a=a.match(/^\w+/),a&&a[0]):this.dict.monthsFull[a[1]]},yyyy:function(a,b){return b?(a=a.match(/^\d{4}/),a&&a[0]):a[0]}},setup:function(){var a=this,b=a.attrs,c=a.intoDateAttr,d=a.compare;return a._super(),b.today=c(new Date),b.min&&(b.min=c(b.min)),b.max&&(b.max=c(b.max)),b.select?b.allowRange?(b.select=b.select.map(function(a){return c(a)}),b.highlight=c(b.select[b.select.length-1])):(b.select=c(b.select),b.highlight=c(b.select)):b.highlight=c(b.highlight?b.highlight:b.today),b.view=c(b.view?[b.view[0],b.view[1],1]:[b.highlight[0],b.highlight[1],1]),a.on("assign:select."+a.id,function(a){var e=a.value;if(e&&b.allowRange){if(Array.isArray(e)||(e=[e]),e.length>1)if(d(e[0],e[1]))e.pop();else{var f=e[0],g=e[1];d(f,"greater",g)&&(f=e[1],g=e[0]),e=[f,g]}e=e.map(function(a){return c(a)})}else e=c(e);a.value=e}),a.on("assign:highlight."+a.id,function(b){var d=a.nextEnabledDate(b.value);b.value=c(d)}),a.on("assign:view."+a.id,function(a){var b=a.value;a.value=c([b[0],b[1],1])}),a.on("set:highlight."+a.id,function(a){b.view=a.value}),a.on("set:select."+a.id,function(a){var c=a.value;c&&(b.allowRange&&(c=c[c.length-1]),b.highlight=c)}),a.on("set:min."+a.id,function(){b.highlight=b.highlight}),a.on("set:max."+a.id,function(){b.highlight=b.highlight}),a},create:function(b){var c=this._super(b),d=c.attrs;return c.$host.on("click","[data-select]",function(b){var c=b.target,e=a(c).data("select");d.select=d.allowRange&&b.shiftKey?[d.select?d.select[0]:d.highlight,new Date(e)]:new Date(e)}),c.$host.on("mousedown","[data-select]",function(a){a.shiftKey&&a.preventDefault()}),c.$host.on("click","[data-highlight]",function(b){var c=b.target,e=a(c).data("highlight");d.highlight=new Date(e),d.show="years"==d.show?"months":null}),c},parse:function(a){var b=this,c=b._super(a);if(!c)return null;var d;return"mmmm"in c?d=b.dict.monthsFull.indexOf(c.mmmm):"mmm"in c&&(d=b.dict.monthsShort.indexOf(c.mmm)),[~~c.yyyy,void 0!==d?d:~~("mm"in c?c.mm:c.m)-1,~~("dd"in c?c.dd:c.d)]},compare:function(a,b,d){var e=arguments;if(e.length<3&&(d=e[1],b=""),!a||!d)return!1;var f=function(a){return Array.isArray(a)?new Date(a[0],a[1],a[2]):new Date(a)};return a=f(a),d=f(d),b.match(/^decade ?/)?(b=b.replace(/^decade ?/,""),a=a.getFullYear(),a-=a%10,d=d.getFullYear(),d-=d%10):b.match(/^year ?/)?(b=b.replace(/^year ?/,""),a=a.getFullYear(),d=d.getFullYear()):b.match(/^month ?/)?(b=b.replace(/^month ?/,""),a.setDate(1),d.setDate(1)):b.match(/^date ?/)&&(b=b.replace(/^date ?/,"")),c.isTypeOf(a,"date")&&(a=a.getTime()),c.isTypeOf(d,"date")&&(d=d.getTime()),"greater equal"==b?a>=d:"lesser equal"==b?d>=a:"greater"==b?a>d:"lesser"==b?d>a:a===d},intoDateAttr:function(a){return a?(Array.isArray(a)&&(a=new Date(a[0],a[1],a[2])),c.isTypeOf(a,"date")&&(a=[a.getFullYear(),a.getMonth(),a.getDate()]),Object.freeze(a),a):a},nextEnabledDate:function(a){var b=this,d=b.attrs;c.isTypeOf(a,"date")&&(a=[a.getFullYear(),a.getMonth(),a.getDate()]),b.compare(d.min,"greater",a)?a=d.min.slice(0):b.compare(d.max,"lesser",a)&&(a=d.max.slice(0));var e=100,f=a[0],g=a[1],h=a[2],i=new Date(f,g,h);for(g=(g+12)%12;e&&i.getMonth()!==g;){if(!e)throw"fell into infinite loop..";e-=1,h-=1,i=new Date(f,g,h)}return i},isSelected:function(a,b){var c=this,d=c.attrs,e=c.compare;if(b=b||"date",d.allowRange){if(!d.select)return!1;if(1===d.select.length)return e(d.select[0],b,a);var f=d.select[0],g=d.select[1];return e(f,b+" lesser equal",a)&&e(g,b+" greater equal",a)}return e(d.select,b,a)},decadeOf:function(a){var b=a%10;return a-=b,[a,a+9]},createHeader:function(){var a=this;return d({name:"header",klass:a.classNames.header},[a.createButtonScope(),a.createButtonNav(),a.createButtonNav("next")])},createBody:function(){var a=this,b=d({klass:a.classNames.body,attrs:{tabIndex:0}},[a.createGrid(null,[a.createGridHeadDates(),a.createGridBodyDates()]),a.createGrid("months",[a.createGridHeadMonths(),a.createGridBodyMonths()]),a.createGrid("years",[a.createGridHeadYears(),a.createGridBodyYears()])]);return b},createFooter:function(){var a=this,b=a.classNames;return d({name:"footer",klass:b.footer},[a.createButtonToday(),a.createButtonClear()])},createButtonNav:function(b){var c=this,e=c.attrs,f=c.classNames,g=c.compare,h="next"==b,i=d({name:"button",klass:f[h?"buttonNext":"buttonPrev"],attrs:{type:"button"}}),j=function(){var a,b="years"==e.show?"decade":"months"==e.show?"year":"month";a=h?g(e.max,b+" lesser equal",e.view):g(e.min,b+" greater equal",e.view),a?(i.classList.add(f.buttonDisabled),i.disabled=!0):i.disabled&&(i.classList.remove(f.buttonDisabled),i.disabled=!1)};return j(),a(i).on("click",function(){var a=e.highlight[0],b=e.highlight[1],c=e.highlight[2],d=h?1:-1;"years"==e.show?a+=10*d:"months"==e.show?a+=d:b+=d,e.highlight=[a,b,c]}),c.on("set:view."+c.id,function(){j()}),c.on("set:show."+c.id,function(){j()}),i},createButtonScope:function(){var b=this,c=b.attrs,e=b.classNames,f=b.dict.monthsFull,g=function(){var a=c.view[0],d=c.view[1];if("years"==c.show){var e=b.decadeOf(a);return e.join(" - ")}return"months"==c.show?a:f[d]+" "+a},h=d({name:"button",klass:e.buttonScope,attrs:{type:"button"}},g());return a(h).on("click",function(){c.show="years"==c.show?null:"months"==c.show?"years":"months"}),b.on("set:show."+b.id,function(){h.innerText=g()}),b.on("set:view."+b.id,function(a){var b=a.value,c=b[0],d=b[1],e=a.previousValue,f=e[0],i=e[1];(c!==f||d!==i)&&(h.innerText=g())}),h},createButtonToday:function(){var b=this,c=b.attrs,e=d({name:"button",klass:b.classNames.buttonToday,attrs:{type:"button"}},b.dict.today);return a(e).on("click",function(){var a=c.today;c.allowRange&&(a=[a]),c.select=a,c.show&&(c.show=null)}),e},createButtonClear:function(){var b=this,c=b.attrs,e=d({name:"button",klass:b.classNames.buttonClear,attrs:{type:"button"}},b.dict.clear);return a(e).on("click",function(){c.select=null,c.show&&(c.show=null)}),e},createGrid:function(b,c){b||(b=null);var e=this,f=e.attrs,g=e.classNames,h=function(a){i.hidden=a!==b},i=d(g.container,d({name:"table",klass:g.grid},c));return h(f.show),e.on("set:show."+e.id,function(a){h(a.value)}),e.on("set:select."+e.id,function(b){b.value||a(i).find("."+g.selected).removeClass(g.selected)}),i},createGridHeadYears:function(){var a=this,b=a.attrs.view[0],c=function(b){var c=a.decadeOf(b);return c.join(" - ")},e=d({name:"th",attrs:{scope:"col",colspan:4}},c(b));return a.on("set:view."+a.id,function(a){var d=a.value[0];d!==b&&(b=d,e.innerText=c(b))}),d({name:"thead"},e)},createGridHeadMonths:function(){var a=this,b=a.attrs.view[0],c=d({name:"th",attrs:{scope:"col",colspan:4}},b);return a.on("set:view."+a.id,function(a){var d=a.value[0];d!==b&&(b=d,c.innerText=b)}),d({name:"thead"},c)},createGridHeadDates:function(){var a=this,b=a.classNames,c=a.attrs,e=a.dict,f=function(){var a=document.createDocumentFragment(),f=e.weekdaysShort.slice(0),g=e.weekdaysFull.slice(0),h=c.firstDay;h&&(f.push(f.shift()),g.push(g.shift()));for(var i=0;7>i;i+=1){var j=d({name:"th",klass:b.gridTitle,attrs:{scope:"col",title:g[i]}},f[i]);a.appendChild(j)}return a},g=d({name:"thead"},f());return a.on("set:firstDay."+a.id,function(){g.innerHTML="",g.appendChild(f())}),g},createGridBodyYears:function(){var a=this,b=a.attrs,c=a.classNames,e=a.compare,f=function(f){var g=new Date(f,b.highlight[1],b.highlight[2]),h=g.getTime(),i=e(b.min,"year greater",h)||e(b.max,"year lesser",h),j=d({name:"td",klass:c.gridCell+" "+(e(b.view,"decade",g)?c.infocus:c.outfocus)+(a.isSelected(h,"year")?" "+c.selected:"")+(e(b.highlight,"year",h)?" "+c.highlighted:"")+(e(b.today,"year",h)?" "+c.now:"")+(i?" "+c.disabled:"")},f);return i||j.setAttribute("data-highlight",h),j},g=function(){for(var c=document.createDocumentFragment(),e=b.view[0],g=a.decadeOf(e)[0],h=0;3>h;h++){for(var i=d({name:"tr"}),j=0;4>j;j++){var k=j+4*h-1,l=f(g+k);i.appendChild(l)}c.appendChild(i)}return c},h=d({name:"tbody"},g());return a.on("set:view."+a.id,function(){h.innerHTML="",h.appendChild(g())}),h},createGridBodyMonths:function(){var a=this,b=a.classNames,c=a.attrs,e=a.dict,f=a.compare,g=function(g){var h=e.monthsShort,i=[c.view[0],g,c.highlight[2]],j=new Date(i[0],i[1],i[2]);j.getMonth()!==g&&(j=a.nextEnabledDate(i));var k=j.getTime(),l=f(c.min,"month greater",k)||f(c.max,"month lesser",k),m=d({name:"td",klass:b.gridCell+(a.isSelected(k,"month")?" "+b.selected:"")+(f(c.highlight,"month",k)?" "+b.highlighted:"")+(f(c.today,"month",k)?" "+b.now:"")+(l?" "+b.disabled:"")},h[j.getMonth()]);return l||m.setAttribute("data-highlight",k),m},h=function(){for(var a=document.createDocumentFragment(),b=0;3>b;b++){for(var c=d({name:"tr"}),e=0;4>e;e++){var f=e+4*b,h=g(f);c.appendChild(h)}a.appendChild(c)}return a},i=d({name:"tbody"},h());return a.on("set:view."+a.id,function(){i.innerHTML="",i.appendChild(h())}),i},createGridBodyDates:function(){var a=this,b=a.attrs,c=a.classNames,e=a.compare,f=function(f,g,h){var i=new Date(f,g,h),j=i.getTime(),k=e(b.min,"greater",j)||e(b.max,"lesser",j),l=d({name:"td",klass:c.gridCell+" "+(b.view[1]===i.getMonth()?c.infocus:c.outfocus)+(a.isSelected(j)?" "+c.selected:"")+(e(b.highlight,j)?" "+c.highlighted:"")+(e(b.today,j)?" "+c.now:"")+(k?" "+c.disabled:"")},i.getDate());return k||l.setAttribute("data-select",j),l},g=function(a,c,e){for(var g=b.firstDay,h=new Date(a,c,1).getDay(),i=document.createDocumentFragment(),j=1;7>=j;j++){var k=7*e+j-h;g&&(k+=1),i.appendChild(f(a,c,k))}return d({name:"tr"},i)},h=function(){var a=b.view[0],c=b.view[1],d=b.firstDay,e=document.createDocumentFragment(),f=0;d&&0===new Date(a,c,1).getDay()&&(f=-1);for(var h=0;5>=h;h++)e.appendChild(g(a,c,h+f));return e},i=d({name:"tbody"},h()),j="set:view."+a.id+" set:firstDay."+a.id;return a.on(j,function(){i.innerHTML="",i.appendChild(h())}),i},template:function(){var a=this,b=a.content;return b.appendChild(a.createHeader()),b.appendChild(a.createBody()),b.appendChild(a.createFooter()),a._super()}})});